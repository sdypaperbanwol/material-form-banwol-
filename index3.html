<!DOCTYPE html>
<html lang="ko">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>ìì¬ ì‹ ì²­</title>
Â  <style>
Â  body {
Â  Â  font-family: 'sans-serif';
Â  Â  background: #f7f7f7;
Â  Â  text-align: center;
Â  Â  padding: 1rem;
Â  Â  margin: 0;
Â  }

Â  .hidden {
Â  display: none !important;}

Â  .step { margin-top: 1.5rem; }

Â  .button-list {
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  align-items: center;
Â  Â  gap: 0.5rem;
Â  Â  margin-bottom: 2rem;
Â  }

Â  button {
Â  Â  padding: 0.6rem 1.2rem;
Â  Â  font-size: 1rem;
Â  Â  border-radius: 6px;
Â  Â  border: none;
Â  Â  background-color: #ddd;
Â  Â  cursor: pointer;
Â  Â  width: 70%;
Â  Â  max-width: 300px;
Â  }

Â  button:hover {
Â  Â  background-color: #4CAF50 !important;
Â  Â  color: white;
Â  }

Â  .selected {
Â  Â  background-color: #4CAF50 !important;
Â  Â  color: white;
Â  Â  font-weight: bold;
Â  }

Â  button:disabled {
Â  Â  background-color: #ccc;
Â  Â  color: #777;
Â  Â  cursor: not-allowed;
Â  }

Â  /* ìˆ˜ëŸ‰ í‘œì‹œ */
Â  #quantity-display {
Â  Â  font-size: 2rem;
Â  Â  margin-bottom: 1rem;
Â  Â  font-weight: bold;
Â  }

#viewPhotos,
#goToTypeBtn {
Â  display: none;
}
#record-buttons:not(.hidden) {
Â  display: flex;
Â  justify-content: center;
Â  gap: 0.8rem;
Â  margin: 0.5rem 0 1rem 0;
Â  flex-wrap: wrap;
}
#loadingOverlay {
Â  z-index: 10000; /* ê¸°ì¡´ 9999ì—ì„œ í•œ ë‹¨ê³„ ë†’ì„ */
}



Â  /* ìˆ˜ëŸ‰ ì…ë ¥ - í‚¤íŒ¨ë“œ + ë¦¬ìŠ¤íŠ¸ ì˜ì—­ */
Â  .quantity-flex-wrapper {
Â  Â  display: flex;
Â  Â  flex-wrap: wrap;
Â  Â  justify-content: center;
Â  Â  gap: 1.5rem;
Â  Â  margin: 2rem 0;
Â  }

Â .numpad-container,
.list-preview-container {
Â  border: 2px solid #ccc; /* âœ… ê¸°ë³¸ì€ íšŒìƒ‰ ë˜ëŠ” ì—°í•œ íšŒìƒ‰ */
Â  background: white;
Â  padding: 1rem;
Â  border-radius: 12px;
Â  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
Â  flex: 1 1 300px;
Â  max-width: 400px;
Â  min-width: 280px;
}

Â .numpad-grid {
Â  display: grid;
Â  grid-template-columns: repeat(3, 1fr);
Â  gap: 0.6rem;
Â  margin: 1rem auto; /* âœ… ì¤‘ì•™ ì •ë ¬ */
Â  width: fit-content;
}

Â  .numpad-grid button {
Â  Â  padding: 1rem;
Â  Â  font-size: 1.5rem;
Â  Â  border-radius: 10px;
Â  Â  background: #e0e0e0;
Â  Â  border: none;
Â  Â  cursor: pointer;
Â  Â  transition: background 0.2s;
Â  }

Â  .numpad-grid button:hover {
Â  Â  background: #ccc;
Â  }

Â  /* ë¹„ê³  ì…ë ¥ */
Â #remarks {
Â  width: 100%;
Â  max-width: 400px;
Â  margin: 1.5rem auto 1rem auto;
Â  padding: 0.6rem;
Â  font-size: 1rem;
Â  border-radius: 6px;
Â  border: 1px solid #ccc;
Â  display: block;
Â  resize: none;
}

Â  /* í•˜ë‹¨ ë²„íŠ¼ ì •ë¦¬ */
Â  .step button {
Â  Â  margin: 0.25rem;
Â  Â  padding: 0.6rem 1rem;
Â  Â  font-size: 1rem;
Â  Â  border-radius: 8px;
Â  Â  border: none;
Â  Â  background: #ddd;
Â  Â  cursor: pointer;
Â  }

Â  .step button:hover {
Â  Â  background: #4CAF50;
Â  Â  color: white;
Â  }

Â  button.back-btn {
Â  Â  margin-top: 1.5rem;
Â  }

Â  /* ë¡œë”© ë©”ì‹œì§€ë“¤ */
Â  #loadingText,
Â  #loginLoadingText,
Â  #submitLoadingText {
Â  Â  margin-top: 1rem;
Â  Â  font-size: 1.1rem;
Â  Â  color: #444;
Â  }
#submitOverlay {
Â  position: fixed;
Â  top: 0;
Â  left: 0;
Â  width: 100vw;
Â  height: 100vh;
Â  background: rgba(0, 0, 0, 0.4);
Â  display: none;
Â  justify-content: center;
Â  align-items: center;
Â  z-index: 9999;
}

#submitOverlay span {
Â  background: white;
Â  padding: 20px 40px;
Â  border-radius: 12px;
Â  font-size: 1.3rem;
Â  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}


Â  /* ì…ë ¥ í•„ë“œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
Â  input {
Â  Â  padding: 0.5rem;
Â  Â  font-size: 1rem;
Â  Â  margin: 0.5rem auto;
Â  Â  width: 80%;
Â  Â  max-width: 300px;
Â  Â  display: block;
Â  }

Â  /* ë¦¬ìŠ¤íŠ¸ ì˜ì—­ */
Â  .list-preview-container {
Â  Â  max-height: 300px;
Â  Â  overflow-y: auto;
Â  Â  background: #f9f9f9;
Â  Â  padding: 1rem;
Â  Â  border-radius: 10px;
Â  Â  font-size: 0.95rem;
Â  }

Â  .list-item-row {
Â  Â  display: flex;
Â  Â  justify-content: space-between;
Â  Â  align-items: center;
Â  Â  padding: 0.4rem 0;
Â  Â  border-bottom: 1px solid #e0e0e0;
Â  }

Â  .list-item-text {
Â  Â  flex: 1;
Â  Â  text-align: left;
Â  Â  word-break: break-word;
Â  Â  padding-right: 0.5rem;
Â  }

Â .delete-btn {
Â  font-size: 0.8rem;
Â  background: transparent;
Â  border: none;
Â  color: #888;
Â  cursor: pointer;
Â  width: 22px;
Â  height: 22px;
Â  display: flex;Â  Â  Â  Â  Â  Â  Â  Â /* ì¤‘ìš”! ì¤‘ì•™ ì •ë ¬ */
Â  align-items: center;Â  Â  Â  Â  Â /* ìˆ˜ì§ ì •ë ¬ */
Â  justify-content: center;Â  Â  Â /* ìˆ˜í‰ ì •ë ¬ */
Â  border-radius: 50%;
Â  transition: background 0.2s;
Â  padding: 0;Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ì•ˆìª½ ì—¬ë°± ì œê±° */
Â  box-sizing: border-box;
}

#login-section input {
Â  padding: 1.00rem; /* âœ… ë†’ì´ ì•½ê°„ ì¦ê°€ */
Â  font-size: 1.05rem;
Â  margin: 0.8rem auto; /* âœ… ê°„ê²© ì•½ê°„ ì¦ê°€ */
Â  width: 80%;
Â  max-width: 300px;
Â  display: block;
Â  border-radius: 6px;
Â  border: 1px solid #ccc;
}

#login-section button {
Â  padding: 1.0rem 1.2rem; /* âœ… ë†’ì´ ì‚´ì§ ì¦ê°€ */
Â  font-size: 1.05rem;
Â  margin-top: 1rem;Â  Â  Â  Â  /* âœ… ìœ„ìª½ ê°„ê²© ë„ì›€ */
Â  border-radius: 8px;
Â  background-color: #4CAF50;
Â  color: white;
Â  border: none;
Â  cursor: pointer;
}


.delete-btn:hover {
Â  background: #ffe5e5;
Â  color: #d00;
}

.button-row {
Â  display: flex;
Â  justify-content: center;
Â  gap: 1rem;
Â  margin: 1rem auto;
Â  flex-wrap: wrap;
}

.half-btn {
Â  flex: 1 1 30%;
Â  max-width: 180px;
Â  min-width: 140px;
Â  padding: 0.6rem 0.8rem;
Â  font-size: 1rem;
Â  border: none;
Â  border-radius: 8px;
Â  background: #ddd;
Â  cursor: pointer;
}

.half-btn:hover {
Â  background: #4CAF50;
Â  color: white;
}

@keyframes pulse {
Â  0% { transform: scale(1); }
Â  50% { transform: scale(1.1); }
Â  100% { transform: scale(1); }
}

.pulse {
Â  animation: pulse 0.6s ease-in-out 2;
}

@keyframes glow {
Â  0%, 100% { box-shadow: 0 0 0px rgba(255, 0, 0, 0.3); }
Â  50% { box-shadow: 0 0 12px rgba(255, 0, 0, 0.7); }
}

.glow {
Â  animation: glow 1.2s ease-in-out 2;
Â  border: 2px solid #ff4444 !important;
}

@keyframes bounce {
Â  0%, 100% { transform: translateY(0); }
Â  50% { transform: translateY(-6px); }
}

.bounce {
Â  animation: bounce 0.4s ease-in-out 2;
}

</style>

</head>
<body>
<div id="initialLoadingOverlay" style="
Â  position: fixed;
Â  top: 0; left: 0;
Â  width: 100vw; height: 100vh;
Â  background: rgba(0,0,0,0.5);
Â  display: flex;
Â  justify-content: center;
Â  align-items: center;
Â  z-index: 9999;
Â  color: white;
Â  font-size: 1.4rem;
">
Â  â³ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...
</div>
<h2 id="title">ğŸ” ì‹ ì²­Â·ì¡°ì‚¬ ì‹œìŠ¤í…œ</h2>
<div id="record-buttons" class="hidden">


Â  <button onclick="openMyRecords()" style="
Â  Â  font-size: 0.9rem;
Â  Â  font-weight: bold;
Â  Â  background-color: #fff;
Â  Â  color: #007bff;
Â  Â  border: 1px solid #007bff;
Â  Â  border-radius: 6px;
Â  Â  padding: 6px 12px;
Â  Â  cursor: pointer;
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  gap: 6px;
Â  Â  box-shadow: 0 1px 4px rgba(0,0,0,0.1);
Â  " onmouseover="this.style.background='#f0f8ff'" onmouseout="this.style.background='#fff'">ğŸ“„ ë‚´ ì‹ ì²­ ë‚´ì—­</button>

Â  <button onclick="openTeamRecords()" style="
Â  Â  font-size: 0.9rem;
Â  Â  font-weight: bold;
Â  Â  background-color: #fff;
Â  Â  color: #28a745;
Â  Â  border: 1px solid #28a745;
Â  Â  border-radius: 6px;
Â  Â  padding: 6px 12px;
Â  Â  cursor: pointer;
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  gap: 6px;
Â  Â  box-shadow: 0 1px 4px rgba(0,0,0,0.1);
Â  " onmouseover="this.style.background='#eaffea'" onmouseout="this.style.background='#fff'">ğŸ‘¥ íŒ€ ì‹ ì²­ ë‚´ì—­</button>
</div>
<div id="login-section">
Â  <div id="inlineNoticeBox" style="
Â  Â  background: #fff3cd;
Â  Â  border: 1px solid #ffeeba;
Â  Â  padding: 10px;
Â  Â  margin: 10px 0;
Â  Â  border-radius: 6px;
Â  Â  color: #856404;
Â  Â  font-size: 0.9rem;
Â  Â  display: none;
Â  Â  white-space: pre-wrap;
Â  "></div>

Â Â 

Â  <p>ì‚¬ë²ˆê³¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”</p>

Â  <input id="empId" placeholder="ì‚¬ë²ˆ" />
Â  <input id="empName" placeholder="ì´ë¦„" />

Â  <button onclick="handleLogin()">ë¡œê·¸ì¸</button>
Â  <div id="loginMsg"></div>

Â  <div id="loginLoadingText" class="hidden">ğŸ” ë¡œê·¸ì¸ ì¤‘ì…ë‹ˆë‹¤...</div>
</div>


<div id="form-section" class="hidden">

Â  <div id="step-category" class="step">
Â  <h3>1ë‹¨ê³„: ëŒ€ë¶„ë¥˜ ì„ íƒ</h3>
Â  <div id="category-buttons" class="button-list"></div>
Â Â 

Â  Â  <button type="button" id="goToTypeBtn" onclick="goToTypeStep()" style="margin-top: 8px;">
Â  â¡ ë‹¤ìŒ ì´ë™
</button>
</div>

<div id="photoModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);z-index:999;overflow:auto;">
Â  <div style="background:white;margin:40px auto;padding:20px;border-radius:10px;max-width:600px;">
Â  Â  <span id="closeModal" style="position:fixed;top:20px;right:20px;font-size:28px;cursor:pointer;z-index:1000;background:white;padding:4px 10px;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,0.2);">âœ–</span>
Â  Â  <div id="photoContent"></div>
Â  </div>
</div>


Â  <div id="step-type" class="step hidden">
Â  <h3>2ë‹¨ê³„: ì¤‘ë¶„ë¥˜ ì„ íƒ</h3>
Â  <div id="type-buttons" class="button-list"></div>
Â Â 
<button type="button" id="viewPhotosType"
Â  style="background:#007bff;color:white;padding:10px;border:none;border-radius:6px;cursor:pointer;margin-top:6px;">
Â  í•­ëª© ì‚¬ì§„ ë³´ê¸°
</button>


Â  <div class="button-row">
Â  Â  <button class="half-btn" onclick="goBackTo('category')">â¬… ë’¤ë¡œê°€ê¸°</button>
Â  Â  <button class="half-btn" id="nextSizeStepBtn" onclick="goToSizeStep()">â¡ ë‹¤ìŒ ì´ë™</button>
Â  </div>
</div>



Â  <div id="step-size" class="step hidden">
Â  <h3>3ë‹¨ê³„: ì†Œë¶„ë¥˜ ì„ íƒ</h3>
Â  <div id="size-buttons" class="button-list"></div>

Â  <div class="button-row">
Â  Â  <button class="half-btn" onclick="goBackTo('type')">â¬… ë’¤ë¡œê°€ê¸°</button>
Â  Â  <button class="half-btn" id="nextQuantityStepBtn" onclick="goToQuantityStep()">â¡ ë‹¤ìŒ ì´ë™</button>
Â  </div>
</div>


<div id="step-quantity" class="step hidden">
Â  <h3>4ë‹¨ê³„: ìˆ˜ëŸ‰ ì…ë ¥</h3>

Â  Â  <div class="numpad-container" style="margin: 0 auto;">
Â  Â  <div id="quantity-display">0</div>
Â  Â  <div id="numpad" class="numpad-grid">
Â  Â  Â  <button onclick="appendQuantity('1')">1</button>
Â  Â  Â  <button onclick="appendQuantity('2')">2</button>
Â  Â  Â  <button onclick="appendQuantity('3')">3</button>
Â  Â  Â  <button onclick="appendQuantity('4')">4</button>
Â  Â  Â  <button onclick="appendQuantity('5')">5</button>
Â  Â  Â  <button onclick="appendQuantity('6')">6</button>
Â  Â  Â  <button onclick="appendQuantity('7')">7</button>
Â  Â  Â  <button onclick="appendQuantity('8')">8</button>
Â  Â  Â  <button onclick="appendQuantity('9')">9</button>
Â  Â  Â  <button onclick="clearQuantity()">C</button>
Â  Â  Â  <button onclick="appendQuantity('0')">0</button>
Â  Â  Â  <button onclick="backspaceQuantity()">â†</button>
Â  Â  </div>
Â  </div>

Â  Â  Â  <textarea id="remarks" placeholder="ë¹„ê³  (ìš”ì²­ì‚¬í•­)" rows="2" style="
Â  width: 100%;
Â  max-width: 400px;
Â  margin: 1.5rem auto 1rem auto;
Â  padding: 0.6rem;
Â  font-size: 1rem;
Â  border-radius: 6px;
Â  border: 1px solid #ccc;
Â  display: block;
Â  resize: none;
"></textarea>

Â Â 
Â  Â  <div class="button-row">
Â  Â  <button class="half-btn" id="addItemToListBtn" onclick="addItemToList()">ğŸ›’ ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°</button>
Â  </div>


Â  Â  <div class="list-preview-container" style="margin: 0 auto; text-align: center;">
Â  <ul id="itemListPreview" style="display: inline-block; text-align: left; font-size: 0.9rem;"></ul>
</div>

Â  <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">
ğŸ› ë‹´ì€ í•­ëª©ì„ í™•ì¸í•˜ì…¨ë‹¤ë©´ <b>ì „ì²´ ì‹ ì²­í•˜ê¸°</b>ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.
</p>

Â  Â  <div class="button-row">
Â  Â  <button class="half-btn" id="submitAllRequestsBtn" onclick="submitAllRequests()">âœ… ì „ì²´ ì‹ ì²­í•˜ê¸°</button>
Â  </div>

Â  Â  <div class="button-row">
Â  Â  <button class="half-btn" onclick="goBackTo('category')">ğŸ“¦ ë‹¤ë¥¸ ë¬¼í’ˆ ì¶”ê°€</button>
Â  </div>

Â  Â  <div class="button-row">
Â  Â  <button class="half-btn" onclick="goBackTo('size')">â¬… ë’¤ë¡œê°€ê¸°</button>
Â  </div>
</div>



<div id="selectedItems" class="step hidden">
Â  <h3>ğŸ“ ì„ íƒëœ í•­ëª© ë¦¬ìŠ¤íŠ¸</h3>
Â  <ul id="itemListDisplay"></ul>
</div>

<div id="myRecordsModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:9999;">
Â  <button onclick="closeMyRecords()" style="
Â  Â  position: fixed;
Â  Â  top: 20px;
Â  Â  right: 20px;
Â  Â  font-size: 22px;
Â  Â  font-weight: bold;
Â  Â  border: none;
Â  Â  background: none;
Â  Â  cursor: pointer;
Â  Â  color: white;
Â  Â  z-index: 10000;
Â  ">âœ–</button>
Â  <div style="
Â  Â  position: relative;
Â  Â  margin: 60px auto 0;
Â  Â  background: white;
Â  Â  padding: 20px 24px 30px;
Â  Â  border-radius: 10px;
Â  Â  max-width: 800px;
Â  Â  width: 95%;
Â  Â  max-height: 80vh;
Â  Â  overflow: auto;
Â  ">
Â  Â  <h3 style="margin-top: 0; margin-bottom: 15px;">ğŸ“„ ì‹ ì²­ ë‚´ì—­</h3>
Â  Â  <table id="myRecordsTable" style="width:100%; font-size: 14px; border-collapse: collapse;">
Â  Â  Â  <thead><tr></tr></thead>
Â  Â  Â  <tbody></tbody>
Â  Â  </table>
Â  </div>
</div>


<script>
Â  const endpoint = 'https://script.google.com/macros/s/AKfycbwyHAXzsq1MXMLEe3HCD11FBqWG6awZlktuKcIOR2CPDNru-GcShGKoMT564PpB_6so/exec'; // ì‹¤ì œ Web App ì£¼ì†Œë¡œ êµì²´

Â  // âœ… ì „ì—­ ë³€ìˆ˜ë“¤ì„ í•˜ë‚˜ì˜ ìƒíƒœ ê°ì²´ë¡œ í†µí•©
Â  let appState = {
Â  Â  loginInfo: { empId: '', empName: '' },
Â  Â  itemData: {},
Â  Â  selected: { category: '', type: '', size: '' },
Â  Â  itemList: [],
Â  Â  quantityValue: ""
Â  };

Â  // DOM ìš”ì†Œ ìºì‹± (ìì£¼ ì‚¬ìš©ë˜ëŠ” ìš”ì†Œ)
Â  const dom = {
Â  Â  initialLoadingOverlay: document.getElementById('initialLoadingOverlay'),
Â  Â  loadingOverlay: document.getElementById('loadingOverlay'),
Â  Â  submitOverlay: document.getElementById('submitOverlay'),
Â  Â  loginSection: document.getElementById('login-section'),
Â  Â  empIdInput: document.getElementById('empId'),
Â  Â  empNameInput: document.getElementById('empName'),
Â  Â  loginButton: document.querySelector('#login-section button'),
Â  Â  loginMsg: document.getElementById('loginMsg'),
Â  Â  loginLoadingText: document.getElementById('loginLoadingText'),
Â  Â  formSection: document.getElementById('form-section'),
Â  Â  title: document.getElementById('title'),
Â  Â  recordButtons: document.getElementById('record-buttons'),
Â  Â  categoryButtonsContainer: document.getElementById('category-buttons'),
Â  Â  goToTypeBtn: document.getElementById('goToTypeBtn'),
Â  Â  typeButtonsContainer: document.getElementById('type-buttons'),
Â  Â  viewPhotosTypeBtn: document.getElementById('viewPhotosType'),
Â  Â  nextSizeStepBtn: document.getElementById('nextSizeStepBtn'), // ìƒˆ ID
Â  Â  sizeButtonsContainer: document.getElementById('size-buttons'),
Â  Â  nextQuantityStepBtn: document.getElementById('nextQuantityStepBtn'), // ìƒˆ ID
Â  Â  quantityDisplay: document.getElementById('quantity-display'),
Â  Â  numpadContainer: document.querySelector('.numpad-container'),
Â  Â  remarksTextarea: document.getElementById('remarks'),
Â  Â  addItemToListBtn: document.getElementById('addItemToListBtn'), // ìƒˆ ID
Â  Â  itemListPreview: document.getElementById('itemListPreview'),
Â  Â  submitAllRequestsBtn: document.getElementById('submitAllRequestsBtn'), // ìƒˆ ID
Â  Â  photoModal: document.getElementById('photoModal'),
Â  Â  photoContent: document.getElementById('photoContent'),
Â  Â  closeModal: document.getElementById('closeModal'),
Â  Â  myRecordsModal: document.getElementById('myRecordsModal'),
Â  Â  myRecordsTableThead: document.querySelector("#myRecordsTable thead"),
Â  Â  myRecordsTableTbody: document.querySelector("#myRecordsTable tbody"),
Â  Â  inlineNoticeBox: document.getElementById("inlineNoticeBox")
Â  };


Â  async function handleLogin() {
Â  Â  const empId = dom.empIdInput.value.trim();
Â  Â  const empName = dom.empNameInput.value.trim();
Â  Â  if (!empId || !empName) {
Â  Â  Â  alert("ì‚¬ë²ˆê³¼ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
Â  Â  Â  return;
Â  Â  }

Â  Â  dom.loginLoadingText.classList.remove('hidden');
Â  Â  dom.loginButton.style.display = 'none'; // ë¡œê·¸ì¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°

Â  Â  try {
Â  Â  Â  const res = await fetch(endpoint, {
Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
Â  Â  Â  Â  body: new URLSearchParams({ empId, empName })
Â  Â  Â  });
Â  Â  Â  const data = await res.json();

Â  Â  Â  if (data.result === 'success') {
Â  Â  Â  Â  appState.loginInfo = { empId, empName };
Â  Â  Â  Â  dom.loginSection.classList.add('hidden');
Â  Â  Â  Â  dom.formSection.classList.remove('hidden');
Â  Â  Â  Â  dom.title.innerText = "ğŸ” ì‹ ì²­Â·ì¡°ì‚¬ ì‹œìŠ¤í…œ";
Â  Â  Â  Â  dom.recordButtons.classList.remove('hidden');
Â  Â  Â  Â  dom.loadingOverlay.style.display = 'flex'; // ì•„ì´í…œ ë¡œë”© ì¤‘ í‘œì‹œ
Â  Â  Â  Â  await loadItems();
Â  Â  Â  } else {
Â  Â  Â  Â  dom.loginMsg.innerText = 'ë¡œê·¸ì¸ ì‹¤íŒ¨ ë˜ëŠ” ê¶Œí•œ ì—†ìŒ';
Â  Â  Â  Â  dom.loginButton.style.display = 'inline-block'; // ì‹¤íŒ¨ ì‹œ ë²„íŠ¼ ë‹¤ì‹œ ë³´ì´ê²Œ
Â  Â  Â  }
Â  Â  } catch (error) {
Â  Â  Â  dom.loginMsg.innerText = 'ì„œë²„ ì˜¤ë¥˜: ' + error.message;
Â  Â  Â  dom.loginButton.style.display = 'block'; // ì˜¤ë¥˜ ì‹œ ë²„íŠ¼ ë‹¤ì‹œ ë³´ì´ê²Œ
Â  Â  } finally {
Â  Â  Â  dom.loginLoadingText.classList.add('hidden');
Â  Â  }
Â  }

Â  async function loadItems() {
Â  Â  try {
Â  Â  Â  const res = await fetch(endpoint);
Â  Â  Â  appState.itemData = await res.json();
Â  Â  Â  const container = dom.categoryButtonsContainer;
Â  Â  Â  container.innerHTML = '';

Â  Â  Â  Object.keys(appState.itemData).forEach(cat => {
Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  btn.innerText = cat;
Â  Â  Â  Â  btn.onclick = () => {
Â  Â  Â  Â  Â  appState.selected.category = cat;
Â  Â  Â  Â  Â  updateSelection(container, btn);
Â  Â  Â  Â  Â  // ë‹¤ìŒ ì´ë™ ë²„íŠ¼ ê°•ì¡°
Â  Â  Â  Â  Â  dom.goToTypeBtn.classList.add('bounce', 'glow');
Â  Â  Â  Â  Â  dom.goToTypeBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
Â  Â  Â  Â  Â  dom.goToTypeBtn.focus();
Â  Â  Â  Â  Â  setTimeout(() => dom.goToTypeBtn.classList.remove('bounce', 'glow'), 1200);
Â  Â  Â  Â  };
Â  Â  Â  Â  container.appendChild(btn);
Â  Â  Â  });

Â  Â  Â  dom.goToTypeBtn.style.display = 'inline-block';
Â  Â  } catch (error) {
Â  Â  Â  alert('âŒ í•­ëª© ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ' + error.message);
Â  Â  } finally {
Â  Â  Â  dom.loadingOverlay.style.display = 'none';
Â  Â  }
Â  }


Â  function selectCategory(cat) {
Â  Â  const types = appState.itemData[cat].types;
Â  Â  const container = dom.typeButtonsContainer;
Â  Â  container.innerHTML = '';

Â  Â  types.forEach(type => {
Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  btn.innerText = type;
Â  Â  Â  btn.onclick = () => {
Â  Â  Â  Â  appState.selected.type = type;
Â  Â  Â  Â  updateSelection(container, btn);
Â  Â  Â  Â  // ë‹¤ìŒ ì´ë™ ë²„íŠ¼ ê°•ì¡°
Â  Â  Â  Â  dom.nextSizeStepBtn.classList.add('bounce', 'glow');
Â  Â  Â  Â  dom.nextSizeStepBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
Â  Â  Â  Â  dom.nextSizeStepBtn.focus();
Â  Â  Â  Â  setTimeout(() => dom.nextSizeStepBtn.classList.remove('bounce', 'glow'), 1200);
Â  Â  Â  };
Â  Â  Â  container.appendChild(btn);
Â  Â  });

Â  Â  showStep('type');
Â  }


Â  function selectType(type) {
Â  Â  const container = dom.sizeButtonsContainer;
Â  Â  container.innerHTML = '';
Â  Â  const stockMap = appState.itemData[appState.selected.category].stockMap;
Â  Â  const sizeKeys = Object.keys(stockMap).filter(k => k.startsWith(type + '__'));

Â  Â  sizeKeys.forEach(k => {
Â  Â  Â  const size = k.split('__')[1];
Â  Â  Â  const stock = stockMap[k];
Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  btn.innerText = `${size} (ì¬ê³ : ${stock})`;
Â  Â  Â  btn.onclick = () => {
Â  Â  Â  Â  appState.selected.size = size;
Â  Â  Â  Â  updateSelection(container, btn);
Â  Â  Â  Â  // ë‹¤ìŒ ì´ë™ ë²„íŠ¼ ê°•ì¡°
Â  Â  Â  Â  dom.nextQuantityStepBtn.classList.add('bounce', 'glow');
Â  Â  Â  Â  dom.nextQuantityStepBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
Â  Â  Â  Â  dom.nextQuantityStepBtn.focus();
Â  Â  Â  Â  setTimeout(() => dom.nextQuantityStepBtn.classList.remove('bounce', 'glow'), 1200);
Â  Â  Â  };
Â  Â  Â  container.appendChild(btn);
Â  Â  });

Â  Â  showStep('size');
Â  }


Â  function selectSize(size) {
Â  Â  showStep('quantity');
Â  Â  if (dom.numpadContainer) {
Â  Â  Â  dom.numpadContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
Â  Â  Â  // ê°•ì¡° ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
Â  Â  Â  dom.numpadContainer.classList.add('glow');
Â  Â  Â  setTimeout(() => dom.numpadContainer.classList.remove('glow'), 1200);
Â  Â  }

Â  Â  // dom.viewPhotos.style.display = "inline-block"; // ì´ ë²„íŠ¼ì€ HTMLì—ì„œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” IDì…ë‹ˆë‹¤.
Â  }


Â  function showStep(step) {
Â  Â  ['category', 'type', 'size', 'quantity'].forEach(s => {
Â  Â  Â  document.getElementById('step-' + s).classList.add('hidden');
Â  Â  });
Â  Â  document.getElementById('step-' + step).classList.remove('hidden');

Â  Â  // ëŒ€ë¶„ë¥˜ ë‹¨ê³„ì—ì„œë§Œ ë²„íŠ¼ ë³´ì´ê¸°
Â  Â  if (step === 'category') {
Â  Â  Â  dom.recordButtons.classList.remove('hidden');
Â  Â  } else {
Â  Â  Â  dom.recordButtons.classList.add('hidden');
Â  Â  }
Â  }


Â  function goBackTo(step) {
Â  Â  showStep(step);
Â  }

Â  function addItemToList() {
Â  Â  const quantity = parseInt(appState.quantityValue, 10);
Â  Â  const remarks = dom.remarksTextarea.value;

Â  Â  if (!quantity || quantity <= 0) {
Â  Â  Â  alert("ì‹ ì²­ ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
Â  Â  Â  return;
Â  Â  }

Â  Â  const stockKey = `${appState.selected.type}__${appState.selected.size}`;
Â  Â  const currentStock = parseInt(appState.itemData[appState.selected.category]?.stockMap?.[stockKey] || "0", 10);
Â  Â  const requestedQty = quantity;

Â  Â  // ì¬ê³  ë¶€ì¡± ì•Œë¦¼
Â  Â  if (requestedQty > currentStock) {
Â  Â  Â  const shortage = requestedQty - currentStock;
Â  Â  Â  if (currentStock > 0) {
Â  Â  Â  Â  alert(`âš ï¸ í˜„ì¬ ${currentStock}ê°œë§Œ ì§€ê¸‰ ê°€ëŠ¥í•˜ë©°, ë‚˜ë¨¸ì§€ ${shortage}ê°œëŠ” êµ¬ë§¤ ìš”ì²­ìœ¼ë¡œ ì ‘ìˆ˜ë©ë‹ˆë‹¤.`);
Â  Â  Â  } else {
Â  Â  Â  Â  alert(`âš ï¸ í˜„ì¬ ì¬ê³ ê°€ ì—†ì–´ ${shortage}ê°œ ì „ëŸ‰ êµ¬ë§¤ ìš”ì²­ìœ¼ë¡œ ì ‘ìˆ˜ë©ë‹ˆë‹¤.`);
Â  Â  Â  }
Â  Â  }

Â  Â  const item = {
Â  Â  Â  name: `${appState.loginInfo.empId} ${appState.loginInfo.empName}`,
Â  Â  Â  category: appState.selected.category,
Â  Â  Â  subcategory: appState.selected.type,
Â  Â  Â  size: appState.selected.size,
Â  Â  Â  quantity: requestedQty,
Â  Â  Â  remarks
Â  Â  };

Â  Â  appState.itemList.push(item);
Â  Â  renderItemList();

Â  Â  appState.quantityValue = ""; // ìˆ˜ëŸ‰ ì´ˆê¸°í™”
Â  Â  updateQuantityDisplay();
Â  Â  dom.remarksTextarea.value = ''; // ë¹„ê³  ì´ˆê¸°í™”

Â  Â  const listBox = dom.itemListPreview.closest('.list-preview-container'); // ë¶€ëª¨ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
Â  Â  if (listBox) {
Â  Â  Â  listBox.classList.add('glow');
Â  Â  Â  setTimeout(() => listBox.classList.remove('glow'), 1200);
Â  Â  }

Â  Â  setTimeout(() => {
Â  Â  Â  dom.submitAllRequestsBtn.classList.add('glow');
Â  Â  Â  setTimeout(() => dom.submitAllRequestsBtn.scrollIntoView({ behavior: 'smooth', block: 'center' }), 300);
Â  Â  Â  setTimeout(() => dom.submitAllRequestsBtn.classList.remove('glow'), 1200);
Â  Â  }, 1300);
Â  }


Â  function renderItemList() {
Â  Â  const previewContainer = dom.itemListPreview;
Â  Â  previewContainer.innerHTML = '';

Â  Â  if (appState.itemList.length === 0) {
Â  Â  Â  const empty = document.createElement('div');
Â  Â  Â  empty.innerText = "â• í•­ëª©ì„ ì¶”ê°€í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.";
Â  Â  Â  empty.style.textAlign = "center";
Â  Â  Â  empty.style.color = "#aaa";
Â  Â  Â  empty.style.padding = "1rem";
Â  Â  Â  previewContainer.appendChild(empty);
Â  Â  Â  return;
Â  Â  }

Â  Â  appState.itemList.forEach((item, index) => {
Â  Â  Â  const row = document.createElement('div');
Â  Â  Â  row.className = 'list-item-row';

Â  Â  Â  const text = document.createElement('div');
Â  Â  Â  text.className = 'list-item-text';
Â  Â  Â  text.innerText = `${item.category} > ${item.subcategory} > ${item.size} - ${item.quantity}ê°œ`
Â  Â  Â  Â  + (item.remarks ? ` (${item.remarks})` : '');

Â  Â  Â  const delBtn = document.createElement('button');
Â  Â  Â  delBtn.className = 'delete-btn';
Â  Â  Â  delBtn.innerText = 'âœ•';
Â  Â  Â  delBtn.onclick = () => {
Â  Â  Â  Â  appState.itemList.splice(index, 1);
Â  Â  Â  Â  renderItemList();
Â  Â  Â  };

Â  Â  Â  row.appendChild(text);
Â  Â  Â  row.appendChild(delBtn);
Â  Â  Â  previewContainer.appendChild(row);
Â  Â  });
Â  }


Â  function resetSteps() {
Â  Â  appState.quantityValue = "";
Â  Â  updateQuantityDisplay();
Â  Â  dom.remarksTextarea.value = '';
Â  Â  showStep('category');
Â  }

Â  async function submitAllRequests() {
Â  Â  if (appState.itemList.length === 0) {
Â  Â  Â  alert("ì‹ ì²­ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.");
Â  Â  Â  return;
Â  Â  }

Â  Â  dom.submitOverlay.style.display = 'flex'; // í™”ë©´ ì¤‘ì•™ ë¡œë”© í‘œì‹œ

Â  Â  try {
Â  Â  Â  for (const item of appState.itemList) {
Â  Â  Â  Â  const stockKey = `${item.subcategory}__${item.size}`;
Â  Â  Â  Â  const stockMap = appState.itemData[item.category]?.stockMap || {};
Â  Â  Â  Â  const currentStock = parseInt(stockMap[stockKey]) || 0;
Â  Â  Â  Â  const quantity = parseInt(item.quantity);
Â  Â  Â  Â  const ì§€ê¸‰ìˆ˜ëŸ‰ = Math.min(quantity, currentStock);
Â  Â  Â  Â  const êµ¬ë§¤ìš”ì²­ìˆ˜ëŸ‰ = Math.max(quantity - currentStock, 0);

Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  name: item.name,
Â  Â  Â  Â  Â  category: item.category,
Â  Â  Â  Â  Â  subcategory: item.subcategory,
Â  Â  Â  Â  Â  size: item.size,
Â  Â  Â  Â  Â  quantity,
Â  Â  Â  Â  Â  remarks: item.remarks,
Â  Â  Â  Â  Â  ì§€ê¸‰ìˆ˜ëŸ‰,
Â  Â  Â  Â  Â  êµ¬ë§¤ìš”ì²­ìˆ˜ëŸ‰
Â  Â  Â  Â  };

Â  Â  Â  Â  await fetch(endpoint, {
Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
Â  Â  Â  Â  Â  body: new URLSearchParams(payload)
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  alert("âœ… ëª¨ë“  í•­ëª©ì´ ì‹ ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.");
Â  Â  Â  location.reload();
Â  Â  } catch (error) {
Â  Â  Â  alert("âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: " + error.message);
Â  Â  } finally {
Â  Â  Â  dom.submitOverlay.style.display = 'none'; // ë¡œë”© ì˜¤ë²„ë ˆì´ ìˆ¨ê¹€
Â  Â  }
Â  }


Â  function appendQuantity(num) {
Â  Â  if (appState.quantityValue.length < 4) {
Â  Â  Â  appState.quantityValue += num;
Â  Â  Â  updateQuantityDisplay();

Â  Â  Â  // í‚¤íŒ¨ë“œ í…Œë‘ë¦¬ ì œê±°
Â  Â  Â  dom.numpadContainer.classList.remove('glow');

Â  Â  Â  // í•­ëª©ì¶”ê°€ ë²„íŠ¼ ê°•ì¡°
Â  Â  Â  dom.addItemToListBtn.classList.add('glow');
Â  Â  Â  setTimeout(() => dom.addItemToListBtn.classList.remove('glow'), 1200);
Â  Â  }
Â  }


Â  function clearQuantity() {
Â  Â  appState.quantityValue = "";
Â  Â  updateQuantityDisplay();
Â  }

Â  function backspaceQuantity() {
Â  Â  appState.quantityValue = appState.quantityValue.slice(0, -1);
Â  Â  updateQuantityDisplay();
Â  }

Â  // í•­ëª© ì‚¬ì§„ ë³´ê¸° ë²„íŠ¼ ë™ì‘
Â  dom.viewPhotosTypeBtn.addEventListener("click", async () => {
Â  Â  const category = appState.selected.category;
Â  Â  if (!category) {
Â  Â  Â  alert("ë¨¼ì € ëŒ€ë¶„ë¥˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
Â  Â  Â  return;
Â  Â  }

Â  Â  dom.loadingOverlay.style.display = "flex"; // ë¡œë”© ì˜¤ë²„ë ˆì´ í‘œì‹œ

Â  Â  try {
Â  Â  Â  const res = await fetch(`${endpoint}?mode=photo`);
Â  Â  Â  const photoMap = await res.json();
Â  Â  Â  const urls = photoMap[category];
Â  Â  Â  const container = dom.photoContent;
Â  Â  Â  container.innerHTML = "";

Â  Â  Â  if (!urls || urls.length === 0) {
Â  Â  Â  Â  container.innerHTML = "<p>í•´ë‹¹ í•­ëª©ì˜ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
Â  Â  Â  } else {
Â  Â  Â  Â  urls.forEach(url => {
Â  Â  Â  Â  Â  const fileName = url.split("/").pop().split(".")[0];
Â  Â  Â  Â  Â  const wrapper = document.createElement("div");
Â  Â  Â  Â  Â  wrapper.style.marginBottom = "20px";
Â  Â  Â  Â  Â  wrapper.innerHTML = `
Â  Â  Â  Â  Â  Â  <div style="font-weight:bold;margin-bottom:5px;">${fileName}</div>
Â  Â  Â  Â  Â  Â  <img src="${url}" style="max-width:100%;border:1px solid #ccc;border-radius:8px;" />
Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  container.appendChild(wrapper);
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  dom.photoModal.style.display = "block"; // ì‚¬ì§„ í‘œì‹œ í›„ ëª¨ë‹¬ ì—´ê¸°
Â  Â  } catch (err) {
Â  Â  Â  alert("âŒ ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: " + err.message);
Â  Â  } finally {
Â  Â  Â  dom.loadingOverlay.style.display = "none"; // ë¡œë”© ì˜¤ë²„ë ˆì´ ë‹«ê¸°
Â  Â  }
Â  });


Â  // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼
Â  dom.closeModal.addEventListener("click", () => {
Â  Â  dom.photoModal.style.display = "none";
Â  });

Â  function goToTypeStep() {
Â  Â  if (!appState.selected.category) {
Â  Â  Â  alert("ëŒ€ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.");
Â  Â  Â  return;
Â  Â  }
Â  Â  selectCategory(appState.selected.category);
Â  }
Â  function goToSizeStep() {
Â  Â  if (!appState.selected.type) {
Â  Â  Â  alert("ì¤‘ë¶„ë¥˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
Â  Â  Â  return;
Â  Â  }
Â  Â  selectType(appState.selected.type);
Â  }
Â  function goToQuantityStep() {
Â  Â  if (!appState.selected.size) {
Â  Â  Â  alert("ì†Œë¶„ë¥˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
Â  Â  Â  return;
Â  Â  }
Â  Â  selectSize(appState.selected.size);
Â  }

Â  document.addEventListener("DOMContentLoaded", async () => {
Â  Â  // ê³µì§€ì‚¬í•­ fetch
Â  Â  try {
Â  Â  Â  const res = await fetch(`${endpoint}?mode=notice`);
Â  Â  Â  const data = await res.json();
Â  Â  Â  const notice = data.notice?.trim();
Â  Â  Â  if (notice) {
Â  Â  Â  Â  dom.inlineNoticeBox.textContent = notice;
Â  Â  Â  Â  dom.inlineNoticeBox.style.display = "block"; // ê³µì§€ ë°•ìŠ¤ í‘œì‹œ
Â  Â  Â  }
Â  Â  } catch (err) {
Â  Â  Â  console.warn("ê³µì§€ì‚¬í•­ ë¡œë”© ì‹¤íŒ¨:", err);
Â  Â  } finally {
Â  Â  Â  dom.initialLoadingOverlay.style.display = 'none'; // ì˜¤ë²„ë ˆì´ ì œê±°
Â  Â  }
Â  });

Â  async function openMyRecords() {
Â  Â  const empId = appState.loginInfo.empId;
Â  Â  dom.loadingOverlay.style.display = 'flex';

Â  Â  try {
Â  Â  Â  const res = await fetch(`${endpoint}?mode=myrecords&empId=${encodeURIComponent(empId)}`);
Â  Â  Â  const data = await res.json();

Â  Â  Â  if (data.result !== "success") {
Â  Â  Â  Â  alert("âŒ ì‹ ì²­ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  renderRecordsTable(data, [0, 2, 4, 5, 6, 9, 10, 8]); // ì‹ ì²­ì¼, ì‹ ì²­ì, ëŒ€ë¶„ë¥˜, ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜, ì§€ê¸‰ìˆ˜ëŸ‰, êµ¬ë§¤ìš”ì²­ìˆ˜ëŸ‰, ë¹„ê³ 
Â  Â  } catch (err) {
Â  Â  Â  alert("âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: " + err.message);
Â  Â  } finally {
Â  Â  Â  dom.loadingOverlay.style.display = 'none';
Â  Â  }
Â  }


Â  async function openTeamRecords() {
Â  Â  const empId = appState.loginInfo.empId;
Â  Â  dom.loadingOverlay.style.display = 'flex'; // ë¡œë”© í‘œì‹œ

Â  Â  try {
Â  Â  Â  const res = await fetch(`${endpoint}?mode=teamrecords&empId=${encodeURIComponent(empId)}`);
Â  Â  Â  const data = await res.json();

Â  Â  Â  if (data.result === "forbidden") {
Â  Â  Â  Â  alert("âš ï¸ íŒ€ ë‚´ì—­ ì¡°íšŒ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  if (data.result !== "success") {
Â  Â  Â  Â  alert("âŒ íŒ€ ì‹ ì²­ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  renderRecordsTable(data, [0, 2, 4, 5, 6, 9, 10]); // ì‹ ì²­ì¼, ì‹ ì²­ì, ëŒ€ë¶„ë¥˜, ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜, ì§€ê¸‰ìˆ˜ëŸ‰, êµ¬ë§¤ìš”ì²­ìˆ˜ëŸ‰
Â  Â  } catch (err) {
Â  Â  Â  alert("âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: " + err.message);
Â  Â  } finally {
Â  Â  Â  dom.loadingOverlay.style.display = 'none'; // ë¡œë”© ë§ˆë¬´ë¦¬
Â  Â  }
Â  }


Â  function renderRecordsTable(data, colIndexes) {
Â  Â  dom.myRecordsTableThead.innerHTML = "<tr>" + colIndexes.map(i =>
Â  Â  Â  `<th style="border:1px solid #ccc; background:#f0f0f0; padding:4px; text-align:center;">${data.header[i]}</th>`
Â  Â  ).join("") + "</tr>";

Â  Â  dom.myRecordsTableTbody.innerHTML = data.records.map(row => {
Â  Â  Â  return "<tr>" + colIndexes.map(i =>
Â  Â  Â  Â  `<td style="border:1px solid #ccc; padding:6px; text-align:center;">${i === 0 ? formatDate(row[i]) : row[i]}</td>`
Â  Â  Â  ).join("") + "</tr>";
Â  Â  }).join("");

Â  Â  dom.myRecordsModal.style.display = "flex";
Â  }

Â  function closeMyRecords() {
Â  Â  dom.myRecordsModal.style.display = "none";
Â  }

Â  function formatDate(raw) {
Â  Â  const d = new Date(raw);
Â  Â  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
Â  }


Â  function updateQuantityDisplay() {
Â  Â  dom.quantityDisplay.innerText = appState.quantityValue || "0";
Â  }

Â  // âœ… updateSelection í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ ìˆ˜ì •
Â  function updateSelection(container, selectedBtn) {
Â  Â  Array.from(container.children).forEach(btn => btn.classList.remove('selected'));
Â  Â  selectedBtn.classList.add('selected');
Â  }

</script>
<div id="submitOverlay">
Â  <span>ğŸ“¤ ì‹ ì²­ ì¤‘ì…ë‹ˆë‹¤...</span>
</div>
<div id="loadingOverlay" style="
Â  position: fixed;
Â  top: 0; left: 0;
Â  width: 100vw; height: 100vh;
Â  background: rgba(0,0,0,0.5);
Â  display: none;
Â  justify-content: center;
Â  align-items: center;
Â  z-index: 9999;
Â  color: white;
Â  font-size: 1.4rem;
">
Â  â³ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...
</div>

</body>
</html>
